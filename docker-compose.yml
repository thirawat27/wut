version: '3.8'

services:
  wut:
    build: .
    image: wut:latest
    container_name: wut
    volumes:
      - wut_data:/home/wut/.wut
      - wut_config:/home/wut/.config/wut
      - /var/run/docker.sock:/var/run/docker.sock:ro
    environment:
      - WUT_DEBUG=false
      - WUT_LOG_LEVEL=info
    restart: unless-stopped
    stdin_open: true
    tty: true
    networks:
      - wut-network

  # Optional: Metrics endpoint
  wut-metrics:
    build: .
    image: wut:latest
    container_name: wut-metrics
    command: ["suggest", "--help"]
    volumes:
      - wut_data:/home/wut/.wut:ro
    ports:
      - "8080:8080"
    environment:
      - WUT_METRICS_ENABLED=true
      - WUT_METRICS_PORT=8080
    restart: unless-stopped
    networks:
      - wut-network

volumes:
  wut_data:
    driver: local
  wut_config:
    driver: local

networks:
  wut-network:
    driver: bridge
